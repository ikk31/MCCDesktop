<Page x:Class="MCCDesktop.Views.HoursPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      mc:Ignorable="d" 
      d:DesignHeight="700" d:DesignWidth="1200"
      Title="Учет рабочего времени">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Учёт рабочего времени" 
                      FontSize="20" 
                      FontWeight="Bold"/>
            <Button x:Name="RefreshBtn" 
                    Content="Обновить" 
                    Margin="20,0,0,0" 
                    Padding="10,5"
                    ToolTip="Обновить данные"
                    Background="#4CAF50"
                    Foreground="White"/>
        </StackPanel>
        <Border Grid.Row="1" 
                Background="#F8F9FA" 
                BorderBrush="#DEE2E6" 
                BorderThickness="1" 
                Padding="15,10"
                Margin="0,0,0,10"
                CornerRadius="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Период:" 
                              VerticalAlignment="Center" 
                              Margin="0,0,10,0"/>
                    <DatePicker x:Name="StartDatePicker" 
                               Width="120" 
                               Height="28"/>
                    <TextBlock Text="—" 
                              VerticalAlignment="Center" 
                              Margin="5,0,5,0"/>
                    <DatePicker x:Name="EndDatePicker" 
                               Width="120" 
                               Height="28"/>
                    <StackPanel Orientation="Horizontal" Margin="20,0,0,0">
                        <Button Content="Сегодня" 
                                Padding="8,3" 
                                Margin="0,0,5,0"
                                Click="QuickFilterToday_Click"
                                ToolTip="Показать смены за сегодня"/>
                        <Button Content="Неделя" 
                                Padding="8,3" 
                                Margin="0,0,5,0"
                                Click="QuickFilterWeek_Click"
                                ToolTip="Показать смены за неделю"/>
                        <Button Content="Месяц" 
                                Padding="8,3"
                                Click="QuickFilterMonth_Click"
                                ToolTip="Показать смены за месяц"/>
                    </StackPanel>
                </StackPanel>
                <StackPanel Grid.Column="1" 
                           Orientation="Horizontal" 
                           Margin="20,0,0,0">
                    <TextBlock Text="Сотрудник:" 
                              VerticalAlignment="Center" 
                              Margin="0,0,10,0"/>

                    <ComboBox x:Name="EmployeeFilter" 
                             Width="250" 
                             Height="28"/>
                </StackPanel>
                <StackPanel Grid.Column="2" 
                           Orientation="Horizontal">
                    <Button x:Name="ApplyFilterBtn" 
                           Content="Применить фильтры" 
                           Padding="12,5" 
                           Margin="0,0,10,0"
                           Background="#6F4E37" 
                           Foreground="White"/>

                    <Button x:Name="ClearFilterBtn" 
                           Content="Сбросить" 
                           Padding="12,5"
                           Background="#9E9E9E" 
                           Foreground="White"/>
                </StackPanel>
            </Grid>
        </Border>
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                <TextBlock Text="Поиск:" 
                          VerticalAlignment="Center" 
                          Margin="0,0,10,0"/>
                <TextBox x:Name="SearchTextBox" 
                        Width="250" 
                        Height="28"
                        Padding="5"
                        TextChanged="SearchTextBox_TextChanged"/>
                <TextBlock x:Name="LoadingIndicator" 
                          Text="⏳ Загрузка..." 
                          Margin="10,0,0,0"
                          VerticalAlignment="Center"
                          Foreground="#2196F3"
                          Visibility="Collapsed"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <TextBlock x:Name="RecordCountText" 
                          Text="Найдено записей: 0" 
                          FontWeight="SemiBold"
                          Margin="0,0,20,0"/>
                <TextBlock x:Name="TotalHoursText" 
                          Text="Всего часов: 0" 
                          FontWeight="SemiBold"
                          Margin="0,0,20,0"
                          Foreground="#2196F3"/>
                <TextBlock x:Name="TotalAmountText" 
                          Text="Общая сумма: 0 руб" 
                          FontWeight="SemiBold"
                          Foreground="#4CAF50"/>
            </StackPanel>
        </StackPanel>
        <DataGrid x:Name="TimeTrackingGrid" 
                 Grid.Row="3"
                 AutoGenerateColumns="False"
                 CanUserAddRows="False"
                 IsReadOnly="True"
                 SelectionMode="Extended"
                 SelectionUnit="FullRow"
                 GridLinesVisibility="Horizontal"
                 RowHeight="35"
                 FontSize="13"
                 VerticalScrollBarVisibility="Auto"
                 HorizontalScrollBarVisibility="Auto">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Дата" 
                                   Binding="{Binding Date, StringFormat=dd.MM.yyyy}" 
                                   Width="100"/>
                <DataGridTextColumn Header="Сотрудник" 
                                   Binding="{Binding IdEmployeeNavigation.Name}" 
                                   Width="180"/>
                <DataGridTextColumn Header="Рабочая точка" 
                                   Binding="{Binding IdWorkplaceNavigation.Name}" 
                                   Width="150"/>
                <DataGridTextColumn Header="Начало" 
                                   Binding="{Binding StartTime, StringFormat=hh\\:mm}" 
                                   Width="80"/>
                <DataGridTextColumn Header="Окончание" 
                                   Binding="{Binding EndTime, StringFormat=hh\\:mm}" 
                                   Width="80"/>
                <DataGridTextColumn Header="Отработано" 
                                   Width="100"
                                    Binding="{Binding WorkHours}"
                                    />
                <DataGridTextColumn Header="Ставка" 
                                   Binding="{Binding HourlyRate, StringFormat=N0}" 
                                   Width="80"/>
                <DataGridTextColumn Header="Сумма" 
                                   Width="100" Binding="{Binding TotalEarned}"/>
                <DataGridTextColumn Header="Комментарий" 
                                   Binding="{Binding Notes}" 
                                   Width="250"/>
            </DataGrid.Columns>
        </DataGrid>
        <Border Grid.Row="4" 
               Background="#F5F5F5" 
               BorderBrush="#E0E0E0" 
               BorderThickness="0,1,0,0"
               Padding="10,8"
               Margin="0,10,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button x:Name="ExportReportBtn" 
                       Grid.Column="0"
                       Content="📥 Экспорт отчета" 
                       Padding="15,6"
                       Background="#2196F3" 
                       Foreground="White"
                       FontWeight="SemiBold"/>
                <TextBlock x:Name="StatusText" 
                          Grid.Column="1"
                          Text="Готово" 
                          Margin="20,0,0,0"
                          VerticalAlignment="Center"
                          Foreground="#666666"/>
            </Grid>
        </Border>
    </Grid>
</Page>